<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>exam-4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Exam 4_files/libs/clipboard/clipboard.min.js"></script>
<script src="Exam 4_files/libs/quarto-html/quarto.js"></script>
<script src="Exam 4_files/libs/quarto-html/popper.min.js"></script>
<script src="Exam 4_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Exam 4_files/libs/quarto-html/anchor.min.js"></script>
<link href="Exam 4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Exam 4_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Exam 4_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Exam 4_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Exam 4_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="Exam 4_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="Exam 4_files/libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="Exam 4_files/libs/vis-9.1.0/vis-network.min.js"></script>
<script src="Exam 4_files/libs/visNetwork-binding-2.1.2/visNetwork.js"></script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<section id="question-4---the-problem" class="level1">
<h1>Question 4 - The Problem</h1>
<ul>
<li><p>Suppose you work for Amazon and they have asked you to (1) determine if a User should get a credit card (yes or no), and (2) determine which products to advertise to the User.</p></li>
<li><p>Imagine that you have any/all of Amazon’s User data – anything you need.</p></li>
</ul>
<ol type="a">
<li><p>Design/create a small dataset that you can use to address the questions above. Paste it here. Keep it small with 3 – 4 columns and 25 – 30 rows. You decide the column/variable names and what the data would look like. It can be anything you want that also makes sense with respect to the question. You create the dataset you need.</p></li>
<li><p>Next, describe, illustrate, and perform (in Python or R) whatever you think you need to do so that you can address the questions asked properly. The reason why you are not being told what tools/methods/models to use is because on the job – you are the data scientist and you determine what to use, what to do, what the results mean, and how to present it. Please do that here.</p></li>
</ol>
<ul>
<li>Discuss and illustrate your technical results and non-technical conclusions. YOU decide what is needed to do this.</li>
</ul>
<section id="data-creation-generation" class="level2">
<h2 class="anchored" data-anchor-id="data-creation-generation">Data Creation / Generation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> (</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    OneHotEncoder, OrdinalEncoder,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> BernoulliNB</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd, numpy <span class="im">as</span> np</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json, matplotlib.pyplot <span class="im">as</span> plt, seaborn <span class="im">as</span> sns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>cust <span class="op">=</span> pd.read_csv(<span class="st">'customer_data.csv'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>cust.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   orders_per_week  ...  needs_cc
0              NaN  ...       NaN
1              NaN  ...       NaN
2              NaN  ...       NaN
3              NaN  ...       NaN
4              NaN  ...       NaN

[5 rows x 4 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, row <span class="kw">in</span> cust.iterrows():</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    cust.at[i,<span class="st">'past_orders'</span>] <span class="op">=</span> json.loads(row[<span class="st">'past_orders'</span>].replace(<span class="st">"'"</span>,<span class="st">'</span><span class="ch">\"</span><span class="st">'</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    cust.loc[i,<span class="st">'total_order_dollars'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>cust.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   orders_per_week  ...  needs_cc
0              NaN  ...       NaN
1              NaN  ...       NaN
2              NaN  ...       NaN
3              NaN  ...       NaN
4              NaN  ...       NaN

[5 rows x 4 columns]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>trans <span class="op">=</span> []</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="bu">open</span>(<span class="st">'./transaction_data.csv'</span>,<span class="st">'w'</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>order_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, row <span class="kw">in</span> cust.iterrows():</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> order <span class="kw">in</span> row[<span class="st">'past_orders'</span>]:</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        order_count<span class="op">+=</span><span class="dv">1</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> item <span class="kw">in</span> order:</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>            s <span class="op">=</span> <span class="st">"</span><span class="sc">{}</span><span class="st">,</span><span class="sc">{}</span><span class="ch">\n</span><span class="st">"</span>.<span class="bu">format</span>(order_count,item) <span class="co">#str(order_count)+','.join(item)+'\n'</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>            f.write(s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>f.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'label'</span>:[],</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'num_purchases'</span>:[],</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'total_purchase_value'</span>:[],</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'item_categories'</span>:[],</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'transactions'</span>:[],</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#'num_purchased_items':[]</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>items <span class="op">=</span> {</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'electronics'</span>:[<span class="st">'computer'</span>,<span class="st">'mouse'</span>,<span class="st">'keyboard'</span>,<span class="st">'headphones'</span>,<span class="st">'watch'</span>,<span class="st">'router'</span>,<span class="st">'power cable'</span>,<span class="st">'printer'</span>],</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'office_supplies'</span>:[<span class="st">'stapler'</span>,<span class="st">'printer paper'</span>,<span class="st">'pens'</span>,<span class="st">'pencils'</span>,<span class="st">'highlighter'</span>,<span class="st">'notepad'</span>],</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'food'</span>:[<span class="st">'chocolate'</span>,<span class="st">'coffee'</span>,<span class="st">'jellybeans'</span>,<span class="st">'chips'</span>,<span class="st">'drink mix'</span>,<span class="st">'coffee creamer'</span>,],</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'clothing'</span>:[<span class="st">'dress'</span>,<span class="st">'t-shirt'</span>,<span class="st">'shorts'</span>,<span class="st">'pants'</span>,<span class="st">'socks'</span>,<span class="st">'formal shoes'</span>,<span class="st">'athletic shoes'</span>,<span class="st">'sandals'</span>],</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'furniture'</span>:[<span class="st">'bed'</span>,<span class="st">'coffee table'</span>,<span class="st">'rug'</span>,<span class="st">'recliner'</span>],</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'outdoor'</span>:[<span class="st">'backpack'</span>,<span class="st">'hiking poles'</span>,<span class="st">'fishing pole'</span>,<span class="st">'folding chair'</span>,<span class="st">'cooler'</span>]</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">9001</span>)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>item_cost_dict <span class="op">=</span> {</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'laptop'</span>: np.random.normal(<span class="dv">1000</span>,<span class="dv">100</span>),</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mouse'</span>: np.random.normal(<span class="dv">35</span>,<span class="dv">4</span>),</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'keyboard'</span>: np.random.normal(<span class="dv">57</span>,<span class="dv">12</span>),</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">'headphones'</span>: np.random.normal(<span class="dv">47</span>,<span class="dv">10</span>),</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">'watch'</span>: np.random.normal(<span class="dv">150</span>,<span class="dv">20</span>),</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">'router'</span>: np.random.normal(<span class="dv">200</span>,<span class="dv">17</span>),</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">'power cable'</span>: np.random.normal(<span class="dv">15</span>,<span class="dv">2</span>),</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">'printer'</span>: np.random.normal(<span class="dv">300</span>,<span class="dv">75</span>),</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">'stapler'</span>: np.random.normal(<span class="dv">15</span>,<span class="dv">1</span>),</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">'printer paper'</span>: np.random.normal(<span class="dv">10</span>,<span class="dv">1</span>),</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">'pens'</span>: np.random.normal(<span class="dv">5</span>,<span class="fl">.5</span>),</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">'pencils'</span>: np.random.normal(<span class="dv">3</span>,<span class="fl">.25</span>),</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">'highlighter'</span>: np.random.normal(<span class="dv">6</span>,<span class="fl">.63</span>),</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">'notepad'</span>: np.random.normal(<span class="fl">2.5</span>,<span class="fl">.25</span>),</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">'chocolate'</span>: np.random.normal(<span class="dv">8</span>,<span class="dv">2</span>),</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">'coffee'</span>: np.random.normal(<span class="dv">12</span>,<span class="fl">1.73</span>),</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">'jellybeans'</span>: np.random.normal(<span class="fl">3.3</span>,<span class="fl">.83</span>),</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">'chips'</span>: np.random.normal(<span class="dv">6</span>,<span class="fl">.37</span>),</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">'drink mix'</span>: np.random.normal(<span class="fl">3.8</span>,<span class="fl">.19</span>),</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">'coffee creamer'</span>: np.random.normal(<span class="fl">6.7</span>,<span class="fl">0.57</span>),</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">'dress'</span>: np.random.normal(<span class="dv">50</span>,<span class="fl">0.329</span>),</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">'t-shirt'</span>: np.random.normal(<span class="fl">13.27</span>,<span class="fl">2.05</span>),</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">'shorts'</span>: np.random.normal(<span class="fl">20.99</span>,<span class="fl">2.28</span>),</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">'pants'</span>: np.random.normal(<span class="fl">27.99</span>,<span class="fl">3.4</span>),</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">'socks'</span>: np.random.normal(<span class="fl">11.99</span>,<span class="fl">1.03</span>),</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">'formal shoes'</span>: np.random.normal(<span class="fl">64.25</span>,<span class="dv">12</span>),</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>    <span class="st">'athletic shoes'</span>: np.random.normal(<span class="fl">84.99</span>,<span class="fl">7.25</span>),</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>    <span class="st">'sandals'</span>: np.random.normal(<span class="fl">15.99</span>,<span class="fl">1.99</span>),</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>    <span class="st">'bed'</span>: np.random.normal(<span class="dv">1500</span>,<span class="fl">175.25</span>),</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">'coffee table'</span>: np.random.normal(<span class="dv">150</span>,<span class="fl">16.97</span>),</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">'rug'</span>: np.random.normal(<span class="dv">227</span>,<span class="dv">22</span>),</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">'recliner'</span>: np.random.normal(<span class="fl">1299.99</span>,<span class="dv">93</span>),</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">'backpack'</span>: np.random.normal(<span class="dv">38</span>,<span class="dv">3</span>),</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>    <span class="st">'hiking poles'</span>: np.random.normal(<span class="dv">55</span>,<span class="fl">2.99</span>),</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>    <span class="st">'fishing rod'</span>: np.random.normal(<span class="fl">175.99</span>,<span class="fl">8.25</span>),</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">'folding chair'</span>: np.random.normal(<span class="dv">42</span>,<span class="dv">10</span>),</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>    <span class="st">'cooler'</span>: np.random.normal(<span class="dv">75</span>,<span class="dv">8</span>),</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>    <span class="st">'beef jerky'</span>:np.random.normal(<span class="fl">17.50</span>,<span class="fl">2.5</span>),</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>    <span class="st">'candy bar'</span>:np.random.normal(<span class="fl">3.42</span>,<span class="fl">0.17</span>),</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>    <span class="st">'potato chips'</span>:np.random.normal(<span class="fl">6.83</span>,<span class="fl">1.1</span>),</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>    <span class="st">'bed sheets'</span>:np.random.normal(<span class="fl">27.95</span>,<span class="fl">3.33</span>),</span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>    <span class="st">'dog treats'</span>:np.random.normal(<span class="fl">18.43</span>,<span class="fl">2.25</span>)</span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>cust[<span class="st">'num_orders'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, row <span class="kw">in</span> cust.iterrows():</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>    cust.loc[i,<span class="st">'num_orders'</span>] <span class="op">=</span><span class="bu">len</span>(row[<span class="st">'past_orders'</span>])</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> order <span class="kw">in</span> row[<span class="st">'past_orders'</span>]:</span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> item <span class="kw">in</span> order:</span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>            price <span class="op">=</span> item_cost_dict[item]</span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>            cust.loc[i,<span class="st">'total_order_dollars'</span>] <span class="op">=</span> cust.loc[i,<span class="st">'total_order_dollars'</span>] <span class="op">+</span> price</span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>cust[<span class="st">'avg_order_amt'</span>] <span class="op">=</span> cust[<span class="st">'total_order_dollars'</span>] <span class="op">/</span> cust[<span class="st">'num_orders'</span>]</span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>cust[<span class="st">'needs_cc'</span>] <span class="op">=</span> np.select([cust[<span class="st">'avg_order_amt'</span>] <span class="op">&gt;</span> <span class="fl">785.53</span>],[<span class="va">True</span>],default<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>cust.drop(columns<span class="op">=</span>[<span class="st">'orders_per_week'</span>,<span class="st">'avg_order_amt'</span>],inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>cust.to_csv(<span class="st">'./Exam4Data.csv'</span>,index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-visualization" class="level2">
<h2 class="anchored" data-anchor-id="data-visualization">Data Visualization</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cust[<span class="st">'avg_order_amt'</span>] <span class="op">=</span> cust[<span class="st">'total_order_dollars'</span>]<span class="op">/</span>cust[<span class="st">'num_orders'</span>]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>,ncols<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>cust,x<span class="op">=</span><span class="st">'avg_order_amt'</span>,binwidth<span class="op">=</span><span class="dv">200</span>,ax<span class="op">=</span>ax[<span class="dv">0</span>])</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>sns.kdeplot(data<span class="op">=</span>cust,x<span class="op">=</span><span class="st">'avg_order_amt'</span>,ax<span class="op">=</span>ax[<span class="dv">1</span>])</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"Distribution of average purchase amounts"</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exam-4_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>cust[<span class="st">'avg_order_amt'</span>].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>count      29.000000
mean      388.113078
std       446.915431
min        19.652671
25%        60.600038
50%       196.383526
75%       700.882110
max      1699.051076
Name: avg_order_amt, dtype: float64</code></pre>
</div>
</div>
<p>People are spending money! Most of our average purchasers fall under the $1000 water mark. Going beyond $1000 can be costly. The users who make larger purchases on average may be more viable customers to whom we could advertise credit. Especially if they’re buying more costly items in the electronics, furniture, or other departments. The median purchase price of $785.43 highlights this as well, a bit more clearly than the histogram.</p>
<p>Let’s go ahead and say that those people do need credit cards. I’ll label the data accordingly and see if we can model of of it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>cust[<span class="st">'needs_cc'</span>] <span class="op">=</span> np.select([cust[<span class="st">'avg_order_amt'</span>] <span class="op">&gt;</span> <span class="fl">785.53</span>],[<span class="va">True</span>],default<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>cust</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    total_order_dollars  ... avg_order_amt
0           1166.550665  ...    388.850222
1            785.534105  ...    196.383526
2           2437.854050  ...    812.618017
3           2102.646329  ...    700.882110
4            395.349357  ...    197.674679
5           2871.096197  ...   1435.548099
6           2949.240125  ...    983.080042
7             23.810467  ...     23.810467
8            136.632712  ...     68.316356
9           1715.034888  ...    857.517444
10          1548.782241  ...    774.391120
11           398.109165  ...    398.109165
12            78.436273  ...     78.436273
13           111.514051  ...    111.514051
14            79.804104  ...     39.902052
15            19.652671  ...     19.652671
16          1144.271756  ...    572.135878
17            46.383817  ...     46.383817
18           637.723892  ...    318.861946
19           121.200075  ...     60.600038
20           295.197832  ...     98.399277
21            68.172580  ...     68.172580
22            24.805923  ...     24.805923
23           111.514051  ...    111.514051
24           373.104569  ...    373.104569
25            21.975791  ...     21.975791
26          1474.975529  ...    737.487764
27          1699.051076  ...   1699.051076
28            36.100253  ...     36.100253

[29 rows x 5 columns]</code></pre>
</div>
</div>
<p>We may be able to build a naive bayes model off of this data, examining past orders, and seeing if a new order may necessitate the customer to get a credit card based on what they have in their cart.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> MultinomialNB,CategoricalNB,BernoulliNB</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> (</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    accuracy_score,roc_auc_score,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    precision_score, recall_score, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    f1_score, confusion_matrix,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    ConfusionMatrixDisplay</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>init_data <span class="op">=</span> cust[[<span class="st">'past_orders'</span>,<span class="st">'needs_cc'</span>]]</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>init_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                          past_orders  needs_cc
0   [[candy bar, chocolate, coffee], [laptop, mous...     False
1   [[backpack, hiking poles, fishing rod, cooler]...     False
2   [[formal shoes, dress, chocolate, coffee, jell...      True
3   [[printer paper, printer, stapler, coffee, cho...     False
4   [[pens, notepad, dog treats], [printer, printe...     False
5   [[laptop, mouse, printer paper, printer, penci...      True
6   [[coffee, chocolate], [rug, recliner], [laptop...      True
7                      [[pens, notepad, power cable]]     False
8   [[headphones, power cable], [potato chips, dri...     False
9   [[router, laptop, printer, printer paper, mous...      True
10              [[pencils, notepad], [rug, recliner]]     False
11           [[coffee, chocolate, coffee table, rug]]     False
12  [[t-shirt, shorts, sandals, beef jerky, dog tr...     False
13                  [[athletic shoes, shorts, socks]]     False
14      [[potato chips, drink mix], [dress, sandals]]     False
15          [[pencils, pens, printer paper, notepad]]     False
16  [[coffee, chocolate], [power cable, headphones...     False
17                       [[t-shirt, shorts, sandals]]     False
18  [[coffee table, rug], [dog treats, fishing rod...     False
19  [[pencils, pens, notepad], [athletic shoes, sh...     False
20  [[cooler, fishing rod, dog treats], [coffee, c...     False
21                                 [[dress, sandals]]     False
22               [[coffee, potato chips, jellybeans]]     False
23                  [[athletic shoes, socks, shorts]]     False
24  [[athletic shoes, socks, shorts, cooler, fishi...     False
25                              [[coffee, chocolate]]     False
26  [[laptop, notepad, pens, pencils, power cable,...     False
27  [[recliner, coffee table, rug, coffee, chocola...      True
28              [[coffee, chocolate, socks, notepad]]     False</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the data in format for Bernoulli Naive Bayes</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>all_items <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>ords <span class="op">=</span> []</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i,row <span class="kw">in</span> init_data.iterrows():</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(row)</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> order <span class="kw">in</span> row[<span class="st">'past_orders'</span>]:</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>        d <span class="op">=</span> {<span class="st">'needs_cc'</span>:row[<span class="st">'needs_cc'</span>]}</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> item <span class="kw">in</span> order:</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>            all_items.add(item)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>            d[item] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        ords.append(d)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>all_items.add(<span class="st">'needs_cc'</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>fr <span class="op">=</span> pd.DataFrame(ords,columns<span class="op">=</span><span class="bu">list</span>(all_items))</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>fr.fillna(<span class="dv">0</span>,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>fr.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   formal shoes  sandals  jellybeans  ...  socks  drink mix  hiking poles
0           0.0      0.0         0.0  ...    0.0        0.0           0.0
1           0.0      0.0         0.0  ...    0.0        0.0           0.0
2           0.0      0.0         0.0  ...    0.0        1.0           0.0
3           0.0      0.0         0.0  ...    0.0        0.0           1.0
4           0.0      0.0         0.0  ...    0.0        1.0           0.0

[5 rows x 37 columns]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#separate the data from the labels</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> fr[<span class="st">'needs_cc'</span>]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>fr.drop(columns<span class="op">=</span><span class="st">'needs_cc'</span>,inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#build a train-test-split, fit, predict</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>bnb <span class="op">=</span> BernoulliNB()</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>X_train,X_test,y_train,y_test <span class="op">=</span> train_test_split(</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    fr,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    labels,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    stratify<span class="op">=</span>labels,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">8808</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    test_size<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>bnb.fit(X_train,y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<style>#sk-container-id-1 {color: black;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>BernoulliNB()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">BernoulliNB</label><div class="sk-toggleable__content"><pre>BernoulliNB()</pre></div></div></div></div></div>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> bnb.predict(X_test)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Model'</span>:[],</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Data'</span>:[],</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Accuracy'</span>:[],</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Precision'</span>:[],</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Recall'</span>:[],</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'F1'</span>:[],</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ROC-AUC'</span>:[]</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>results.loc[<span class="bu">len</span>(results)] <span class="op">=</span> {</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Model'</span>:<span class="st">'BernoulliNB'</span>,</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Accuracy'</span>:accuracy_score(y_test,y_pred),</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Precision'</span>:precision_score(y_test,y_pred),</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Recall'</span>:recall_score(y_test,y_pred),</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'F1'</span>:f1_score(y_test,y_pred),</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ROC-AUC'</span>:roc_auc_score(y_test,y_pred)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<style type="text/css">
</style>

<table id="T_1edb3" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_1edb3_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">Model</th>
<th id="T_1edb3_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">Data</th>
<th id="T_1edb3_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">Accuracy</th>
<th id="T_1edb3_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">Precision</th>
<th id="T_1edb3_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">Recall</th>
<th id="T_1edb3_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">F1</th>
<th id="T_1edb3_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">ROC-AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_1edb3_row0_col0" class="data row0 col0">BernoulliNB</td>
<td id="T_1edb3_row0_col1" class="data row0 col1">nan</td>
<td id="T_1edb3_row0_col2" class="data row0 col2">1.000000</td>
<td id="T_1edb3_row0_col3" class="data row0 col3">1.000000</td>
<td id="T_1edb3_row0_col4" class="data row0 col4">1.000000</td>
<td id="T_1edb3_row0_col5" class="data row0 col5">1.000000</td>
<td id="T_1edb3_row0_col6" class="data row0 col6">1.000000</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>ConfusionMatrixDisplay(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    confusion_matrix(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>        y_pred<span class="op">=</span>y_pred,y_true<span class="op">=</span>y_test</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>).plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay object at 0x00000254E2163850&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Confusion Matrix - Bernoulli Naive Bayes for Credit Cards"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exam-4_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This is a very limited sample for training and testing data, so the model performs absurdly well on the limited information. It has 100% performance for all metrics, and this could be a sign of overfitting from limited data. It would be good to see if an oversampling of this data produces similar, or to gather more records from the actual customer database.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#make copies of all source records so we have more with which to assess.</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>oversamp <span class="op">=</span> fr.copy()</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>lab_2 <span class="op">=</span> labels.copy()</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    oversamp <span class="op">=</span> pd.concat([oversamp,oversamp])</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    lab_2 <span class="op">=</span> pd.concat([lab_2,lab_2])</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>X_train,X_test,y_train,y_test <span class="op">=</span> train_test_split(</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    oversamp,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    lab_2,</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    stratify<span class="op">=</span>lab_2,</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">8809</span>,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    test_size<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>bnb.fit(X_train,y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<style>#sk-container-id-2 {color: black;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>BernoulliNB()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked=""><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">BernoulliNB</label><div class="sk-toggleable__content"><pre>BernoulliNB()</pre></div></div></div></div></div>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> bnb.predict(X_test)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Model'</span>:[],</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Data'</span>:[],</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Accuracy'</span>:[],</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Precision'</span>:[],</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Recall'</span>:[],</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'F1'</span>:[],</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ROC-AUC'</span>:[]</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>results.loc[<span class="bu">len</span>(results)] <span class="op">=</span> {</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Model'</span>:<span class="st">'BernoulliNB (No Tuning)'</span>,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Data'</span>:<span class="st">'Oversampled'</span>,</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Accuracy'</span>:accuracy_score(y_test,y_pred),</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Precision'</span>:precision_score(y_test,y_pred),</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Recall'</span>:recall_score(y_test,y_pred),</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'F1'</span>:f1_score(y_test,y_pred),</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ROC-AUC'</span>:roc_auc_score(y_test,y_pred)</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>ConfusionMatrixDisplay(</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    confusion_matrix(</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>        y_pred<span class="op">=</span>y_pred,y_true<span class="op">=</span>y_test</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>).plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay object at 0x00000254E2698970&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Confusion Matrix - Bernoulli Naive Bayes for Credit Cards"</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exam-4_files/figure-html/unnamed-chunk-14-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<style type="text/css">
</style>

<table id="T_18f2b" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_18f2b_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">Model</th>
<th id="T_18f2b_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">Data</th>
<th id="T_18f2b_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">Accuracy</th>
<th id="T_18f2b_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">Precision</th>
<th id="T_18f2b_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">Recall</th>
<th id="T_18f2b_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">F1</th>
<th id="T_18f2b_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">ROC-AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_18f2b_row0_col0" class="data row0 col0">BernoulliNB (No Tuning)</td>
<td id="T_18f2b_row0_col1" class="data row0 col1">Oversampled</td>
<td id="T_18f2b_row0_col2" class="data row0 col2">0.849108</td>
<td id="T_18f2b_row0_col3" class="data row0 col3">0.605902</td>
<td id="T_18f2b_row0_col4" class="data row0 col4">0.820240</td>
<td id="T_18f2b_row0_col5" class="data row0 col5">0.696964</td>
<td id="T_18f2b_row0_col6" class="data row0 col6">0.838547</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The oversampling reveals that the model still performs decently well overall with a larger base of records. Of interest and note to the company is the higher prevalence of false positives over false negatives. The model would recommend more often credit cards for people who don’t need them, and would less often make a false prediction that they don’t need a credit card when they actually do.</p>
<p>The model performance metrics decreased with this oversampling, but remained relatively high in the areas where the company is likely to care. Retaining high accuracy means we’ll often make the right recommendation to the right customer. The high recall means we may recommend credit cards to customers that don’t need them.</p>
<p>This points to a need for a greater amount of data to better assess customer purchases. It also points to the method used to add the labels to orders for whether or not a customer needed a credit card; the need for a credit card was based upon <em>customer</em> information, whereas the model has been built from <em>order</em> data. Of the two, a larger representative sample of customer and order information is preferrable.</p>
<p>This method is still relatively effective. Ideally, I think it would be more impactful to decrease false negatives and increase false positives (i.e.&nbsp;recommend credit cards to customers that don’t necessarily need them). This shift may increase our chances of getting more customers to get credit cards whether they need them or not, and also avoid falsely predicting that a customer that needs a credit card doesn’t need one.</p>
<p>I’ll do a quick imbalance on the classification weighting to adjust this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>bnb <span class="op">=</span> BernoulliNB(class_prior<span class="op">=</span>(<span class="fl">.55</span>,<span class="fl">.45</span>))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>bnb.fit(X_train,y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<style>#sk-container-id-3 {color: black;}#sk-container-id-3 pre{padding: 0;}#sk-container-id-3 div.sk-toggleable {background-color: white;}#sk-container-id-3 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-3 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-3 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-3 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-3 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-3 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-3 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-3 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-3 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-3 div.sk-item {position: relative;z-index: 1;}#sk-container-id-3 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-3 div.sk-item::before, #sk-container-id-3 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-3 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-3 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-3 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-3 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-3 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-3 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-3 div.sk-label-container {text-align: center;}#sk-container-id-3 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-3 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-3" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>BernoulliNB(class_prior=(0.55, 0.45))</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox" checked=""><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">BernoulliNB</label><div class="sk-toggleable__content"><pre>BernoulliNB(class_prior=(0.55, 0.45))</pre></div></div></div></div></div>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> bnb.predict(X_test)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Model'</span>:[],</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Data'</span>:[],</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Accuracy'</span>:[],</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Precision'</span>:[],</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Recall'</span>:[],</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'F1'</span>:[],</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ROC-AUC'</span>:[]</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>results.loc[<span class="bu">len</span>(results)] <span class="op">=</span> {</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Model'</span>:<span class="st">'BernoulliNB (Class Priors 0.6 / 0.4)'</span>,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Data'</span>:<span class="st">'Oversampled'</span>,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Accuracy'</span>:accuracy_score(y_test,y_pred),</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Precision'</span>:precision_score(y_test,y_pred),</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Recall'</span>:recall_score(y_test,y_pred),</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'F1'</span>:f1_score(y_test,y_pred),</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ROC-AUC'</span>:roc_auc_score(y_test,y_pred)</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>ConfusionMatrixDisplay(</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    confusion_matrix(</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>        y_pred<span class="op">=</span>y_pred,y_true<span class="op">=</span>y_test</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>).plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay object at 0x00000254E221B7C0&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Confusion Matrix - Bernoulli Naive Bayes for Credit Cards</span><span class="ch">\n</span><span class="st">Oversampled Data; Class Priors Adjusted (1)"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exam-4_files/figure-html/unnamed-chunk-16-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<style type="text/css">
</style>

<table id="T_948ba" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_948ba_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">Model</th>
<th id="T_948ba_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">Data</th>
<th id="T_948ba_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">Accuracy</th>
<th id="T_948ba_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">Precision</th>
<th id="T_948ba_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">Recall</th>
<th id="T_948ba_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">F1</th>
<th id="T_948ba_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">ROC-AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_948ba_row0_col0" class="data row0 col0">BernoulliNB (Class Priors 0.6 / 0.4)</td>
<td id="T_948ba_row0_col1" class="data row0 col1">Oversampled</td>
<td id="T_948ba_row0_col2" class="data row0 col2">0.828732</td>
<td id="T_948ba_row0_col3" class="data row0 col3">0.552612</td>
<td id="T_948ba_row0_col4" class="data row0 col4">1.000000</td>
<td id="T_948ba_row0_col5" class="data row0 col5">0.711848</td>
<td id="T_948ba_row0_col6" class="data row0 col6">0.891390</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Of the two models, the first may be more ideal for the company (with no adjustment to prior class probabilities). This adjustment had a better balanced recall vs.&nbsp;precision; while not always making correct predictions, it also does not go in the direction of overrecommendation, or potentially annoying customers with credit card advertisements when they are just routine purchasers for small groups of items and may not need a credit card. Limiting the advertisements to mostly those who need the credit card, along side some who do not, is likely in greater interest to the company. The first oversampling model also has a higher accuracy than the model with adjusted class prior probabilities.</p>
<p>Having additional customer data beyond past orders and average order amounts may be beneficial. This modeling is also based upon a limited number of records and product types. Having a larger sample of customer information, data on who actually gets a credit card from our company, and some other pertinent items could make for more effective models and boost company profits.</p>
<p>Overall - this method can certainly be used to perform further work and make recommendations to customers who may need credit cards.</p>
</section>
<section id="purchase-recommendations" class="level2">
<h2 class="anchored" data-anchor-id="purchase-recommendations">Purchase Recommendations</h2>
<p>To evaluate recommendations for combined purchases, performing association rule mining may be best. This can tell us how likely certain items will be purchased together, based upon historical transaction data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(arules)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(arulesViz)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.transactions</span>(</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'C:/Users/pconn/OneDrive/Desktop/transaction_data.csv'</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep=</span><span class="st">','</span>,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">rm.duplicates=</span><span class="cn">TRUE</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">format=</span><span class="st">'single'</span>,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     items             transactionID
[1]  {candy bar,                    
      chocolate,                    
      coffee}                     1 
[2]  {chocolate,                    
      coffee,                       
      coffee table,                 
      rug}                        10
[3]  {chocolate,                    
      coffee,                       
      printer,                      
      printer paper,                
      stapler}                    11
[4]  {coffee table,                 
      recliner,                     
      rug}                        12
[5]  {beef jerky,                   
      dog treats}                 13
[6]  {dog treats,                   
      notepad,                      
      pens}                       14
[7]  {power cable,                  
      printer,                      
      printer paper}              15
[8]  {laptop,                       
      mouse,                        
      notepad,                      
      pencils,                      
      printer,                      
      printer paper}              16
[9]  {coffee table,                 
      power cable,                  
      recliner}                   17
[10] {chocolate,                    
      coffee}                     18
[11] {recliner,                     
      rug}                        19
[12] {headphones,                   
      laptop,                       
      mouse,                        
      notepad,                      
      pens}                       2 
[13] {laptop,                       
      power cable,                  
      printer}                    20
[14] {notepad,                      
      pens,                         
      power cable}                21
[15] {headphones,                   
      power cable}                22
[16] {dog treats,                   
      drink mix,                    
      potato chips,                 
      sandals,                      
      shorts,                       
      t-shirt}                    23
[17] {headphones,                   
      laptop,                       
      mouse,                        
      power cable,                  
      printer,                      
      printer paper,                
      router}                     24
[18] {chocolate,                    
      coffee}                     25
[19] {notepad,                      
      pencils}                    26
[20] {recliner,                     
      rug}                        27
[21] {chocolate,                    
      coffee,                       
      coffee table,                 
      rug}                        28
[22] {beef jerky,                   
      dog treats,                   
      sandals,                      
      shorts,                       
      t-shirt}                    29
[23] {drink mix,                    
      potato chips,                 
      power cable}                3 
[24] {athletic shoes,               
      shorts,                       
      socks}                      30
[25] {drink mix,                    
      potato chips}               31
[26] {dress,                        
      sandals}                    32
[27] {notepad,                      
      pencils,                      
      pens,                         
      printer paper}              33
[28] {chocolate,                    
      coffee}                     34
[29] {headphones,                   
      laptop,                       
      mouse,                        
      power cable}                35
[30] {sandals,                      
      shorts,                       
      t-shirt}                    36
[31] {coffee table,                 
      rug}                        37
[32] {cooler,                       
      dog treats,                   
      fishing rod}                38
[33] {notepad,                      
      pencils,                      
      pens}                       39
[34] {backpack,                     
      cooler,                       
      fishing rod,                  
      hiking poles}               4 
[35] {athletic shoes,               
      shorts,                       
      socks}                      40
[36] {cooler,                       
      dog treats,                   
      fishing rod}                41
[37] {chocolate,                    
      coffee}                     42
[38] {drink mix,                    
      potato chips}               43
[39] {dress,                        
      sandals}                    44
[40] {coffee,                       
      jellybeans,                   
      potato chips}               45
[41] {athletic shoes,               
      shorts,                       
      socks}                      46
[42] {athletic shoes,               
      cooler,                       
      dog treats,                   
      fishing rod,                  
      shorts,                       
      socks}                      47
[43] {chocolate,                    
      coffee}                     48
[44] {laptop,                       
      notepad,                      
      pencils,                      
      pens,                         
      power cable,                  
      printer,                      
      printer paper}              49
[45] {chocolate,                    
      coffee,                       
      drink mix,                    
      potato chips}               5 
[46] {dress,                        
      jellybeans,                   
      sandals}                    50
[47] {chocolate,                    
      coffee,                       
      coffee table,                 
      recliner,                     
      rug}                        51
[48] {chocolate,                    
      coffee,                       
      notepad,                      
      socks}                      52
[49] {notepad,                      
      pens,                         
      printer,                      
      printer paper}              6 
[50] {sandals,                      
      shorts,                       
      t-shirt}                    7 
[51] {chocolate,                    
      coffee,                       
      dress,                        
      formal shoes,                 
      jellybeans}                 8 
[52] {bed,                          
      bed sheets,                   
      chips,                        
      drink mix}                  9 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>a_rules <span class="ot">&lt;-</span> arules<span class="sc">::</span><span class="fu">apriori</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    data,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">control=</span><span class="fu">list</span>(<span class="at">verbose=</span>F),</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">parameter=</span><span class="fu">list</span>(<span class="at">support=</span><span class="fl">0.07</span>,<span class="at">confidence=</span><span class="fl">0.07</span>,<span class="at">minlen=</span><span class="dv">2</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>arules<span class="sc">::</span><span class="fu">inspect</span>(a_rules)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     lhs                         rhs              support    confidence
[1]  {athletic shoes}         =&gt; {socks}          0.07692308 1.0000000 
[2]  {socks}                  =&gt; {athletic shoes} 0.07692308 0.8000000 
[3]  {athletic shoes}         =&gt; {shorts}         0.07692308 1.0000000 
[4]  {shorts}                 =&gt; {athletic shoes} 0.07692308 0.5000000 
[5]  {recliner}               =&gt; {rug}            0.07692308 0.8000000 
[6]  {rug}                    =&gt; {recliner}       0.07692308 0.5714286 
[7]  {cooler}                 =&gt; {fishing rod}    0.07692308 1.0000000 
[8]  {fishing rod}            =&gt; {cooler}         0.07692308 1.0000000 
[9]  {t-shirt}                =&gt; {sandals}        0.07692308 1.0000000 
[10] {sandals}                =&gt; {t-shirt}        0.07692308 0.5714286 
[11] {t-shirt}                =&gt; {shorts}         0.07692308 1.0000000 
[12] {shorts}                 =&gt; {t-shirt}        0.07692308 0.5000000 
[13] {socks}                  =&gt; {shorts}         0.07692308 0.8000000 
[14] {shorts}                 =&gt; {socks}          0.07692308 0.5000000 
[15] {potato chips}           =&gt; {drink mix}      0.09615385 0.8333333 
[16] {drink mix}              =&gt; {potato chips}   0.09615385 0.8333333 
[17] {coffee table}           =&gt; {rug}            0.09615385 0.8333333 
[18] {rug}                    =&gt; {coffee table}   0.09615385 0.7142857 
[19] {mouse}                  =&gt; {laptop}         0.07692308 1.0000000 
[20] {laptop}                 =&gt; {mouse}          0.07692308 0.6666667 
[21] {pencils}                =&gt; {notepad}        0.09615385 1.0000000 
[22] {notepad}                =&gt; {pencils}        0.09615385 0.5000000 
[23] {sandals}                =&gt; {shorts}         0.07692308 0.5714286 
[24] {shorts}                 =&gt; {sandals}        0.07692308 0.5000000 
[25] {pens}                   =&gt; {notepad}        0.13461538 1.0000000 
[26] {notepad}                =&gt; {pens}           0.13461538 0.7000000 
[27] {laptop}                 =&gt; {power cable}    0.07692308 0.6666667 
[28] {power cable}            =&gt; {laptop}         0.07692308 0.4444444 
[29] {laptop}                 =&gt; {printer}        0.07692308 0.6666667 
[30] {printer}                =&gt; {laptop}         0.07692308 0.5714286 
[31] {power cable}            =&gt; {printer}        0.07692308 0.4444444 
[32] {printer}                =&gt; {power cable}    0.07692308 0.5714286 
[33] {printer}                =&gt; {printer paper}  0.11538462 0.8571429 
[34] {printer paper}          =&gt; {printer}        0.11538462 0.8571429 
[35] {printer paper}          =&gt; {notepad}        0.07692308 0.5714286 
[36] {notepad}                =&gt; {printer paper}  0.07692308 0.4000000 
[37] {chocolate}              =&gt; {coffee}         0.25000000 1.0000000 
[38] {coffee}                 =&gt; {chocolate}      0.25000000 0.9285714 
[39] {athletic shoes, socks}  =&gt; {shorts}         0.07692308 1.0000000 
[40] {athletic shoes, shorts} =&gt; {socks}          0.07692308 1.0000000 
[41] {shorts, socks}          =&gt; {athletic shoes} 0.07692308 1.0000000 
[42] {sandals, t-shirt}       =&gt; {shorts}         0.07692308 1.0000000 
[43] {shorts, t-shirt}        =&gt; {sandals}        0.07692308 1.0000000 
[44] {sandals, shorts}        =&gt; {t-shirt}        0.07692308 1.0000000 
     coverage   lift      count
[1]  0.07692308 10.400000  4   
[2]  0.09615385 10.400000  4   
[3]  0.07692308  6.500000  4   
[4]  0.15384615  6.500000  4   
[5]  0.09615385  5.942857  4   
[6]  0.13461538  5.942857  4   
[7]  0.07692308 13.000000  4   
[8]  0.07692308 13.000000  4   
[9]  0.07692308  7.428571  4   
[10] 0.13461538  7.428571  4   
[11] 0.07692308  6.500000  4   
[12] 0.15384615  6.500000  4   
[13] 0.09615385  5.200000  4   
[14] 0.15384615  5.200000  4   
[15] 0.11538462  7.222222  5   
[16] 0.11538462  7.222222  5   
[17] 0.11538462  6.190476  5   
[18] 0.13461538  6.190476  5   
[19] 0.07692308  8.666667  4   
[20] 0.11538462  8.666667  4   
[21] 0.09615385  5.200000  5   
[22] 0.19230769  5.200000  5   
[23] 0.13461538  3.714286  4   
[24] 0.15384615  3.714286  4   
[25] 0.13461538  5.200000  7   
[26] 0.19230769  5.200000  7   
[27] 0.11538462  3.851852  4   
[28] 0.17307692  3.851852  4   
[29] 0.11538462  4.952381  4   
[30] 0.13461538  4.952381  4   
[31] 0.17307692  3.301587  4   
[32] 0.13461538  3.301587  4   
[33] 0.13461538  6.367347  6   
[34] 0.13461538  6.367347  6   
[35] 0.13461538  2.971429  4   
[36] 0.19230769  2.971429  4   
[37] 0.25000000  3.714286 13   
[38] 0.26923077  3.714286 13   
[39] 0.07692308  6.500000  4   
[40] 0.07692308 10.400000  4   
[41] 0.07692308 13.000000  4   
[42] 0.07692308  6.500000  4   
[43] 0.07692308  7.428571  4   
[44] 0.07692308 13.000000  4   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>sorted_arules <span class="ot">&lt;-</span> <span class="fu">sort</span>(a_rules,<span class="at">by=</span><span class="st">'lift'</span>,<span class="at">decreasing =</span> T)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># arules::inspect(sorted_arules[1:25])</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>sub <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">sort</span>(a_rules,<span class="at">by=</span><span class="st">'lift'</span>,<span class="at">decreasing =</span> T),<span class="dv">15</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sub,<span class="at">method=</span><span class="st">"graph"</span>,<span class="at">engine=</span><span class="st">"html"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-a5a22dff9255ca040266" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a5a22dff9255ca040266">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],"label":["athletic shoes","cooler","drink mix","fishing rod","laptop","mouse","potato chips","sandals","shorts","socks","t-shirt","rule 1","rule 2","rule 3","rule 4","rule 5","rule 6","rule 7","rule 8","rule 9","rule 10","rule 11","rule 12","rule 13","rule 14","rule 15"],"group":[1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],"value":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,100,100,1],"color":["#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#EE1B1B","#EE1B1B","#EE1B1B","#EE1B1B","#EE7E7E","#EE7E7E","#EE7E7E","#EEAEAE","#EEAEAE","#EEC8C8","#EEC8C8","#EEC8C8","#EECDCD","#EECDCD","#EEDCDC"],"title":["athletic shoes","cooler","drink mix","fishing rod","laptop","mouse","potato chips","sandals","shorts","socks","t-shirt","<B>[1]<\/B><BR><B>{cooler}<\/B><BR>&nbsp;&nbsp; => <B>{fishing rod}<\/B><BR><BR>support = 0.0769<BR>confidence = 1<BR>coverage = 0.0769<BR>lift = 13<BR>count = 4<BR>order = 2<BR>id = 1","<B>[2]<\/B><BR><B>{fishing rod}<\/B><BR>&nbsp;&nbsp; => <B>{cooler}<\/B><BR><BR>support = 0.0769<BR>confidence = 1<BR>coverage = 0.0769<BR>lift = 13<BR>count = 4<BR>order = 2<BR>id = 2","<B>[3]<\/B><BR><B>{shorts,<BR>&nbsp;&nbsp;socks}<\/B><BR>&nbsp;&nbsp; => <B>{athletic shoes}<\/B><BR><BR>support = 0.0769<BR>confidence = 1<BR>coverage = 0.0769<BR>lift = 13<BR>count = 4<BR>order = 3<BR>id = 3","<B>[4]<\/B><BR><B>{sandals,<BR>&nbsp;&nbsp;shorts}<\/B><BR>&nbsp;&nbsp; => <B>{t-shirt}<\/B><BR><BR>support = 0.0769<BR>confidence = 1<BR>coverage = 0.0769<BR>lift = 13<BR>count = 4<BR>order = 3<BR>id = 4","<B>[5]<\/B><BR><B>{athletic shoes}<\/B><BR>&nbsp;&nbsp; => <B>{socks}<\/B><BR><BR>support = 0.0769<BR>confidence = 1<BR>coverage = 0.0769<BR>lift = 10.4<BR>count = 4<BR>order = 2<BR>id = 5","<B>[6]<\/B><BR><B>{socks}<\/B><BR>&nbsp;&nbsp; => <B>{athletic shoes}<\/B><BR><BR>support = 0.0769<BR>confidence = 0.8<BR>coverage = 0.0962<BR>lift = 10.4<BR>count = 4<BR>order = 2<BR>id = 6","<B>[7]<\/B><BR><B>{athletic shoes,<BR>&nbsp;&nbsp;shorts}<\/B><BR>&nbsp;&nbsp; => <B>{socks}<\/B><BR><BR>support = 0.0769<BR>confidence = 1<BR>coverage = 0.0769<BR>lift = 10.4<BR>count = 4<BR>order = 3<BR>id = 7","<B>[8]<\/B><BR><B>{mouse}<\/B><BR>&nbsp;&nbsp; => <B>{laptop}<\/B><BR><BR>support = 0.0769<BR>confidence = 1<BR>coverage = 0.0769<BR>lift = 8.67<BR>count = 4<BR>order = 2<BR>id = 8","<B>[9]<\/B><BR><B>{laptop}<\/B><BR>&nbsp;&nbsp; => <B>{mouse}<\/B><BR><BR>support = 0.0769<BR>confidence = 0.667<BR>coverage = 0.115<BR>lift = 8.67<BR>count = 4<BR>order = 2<BR>id = 9","<B>[10]<\/B><BR><B>{t-shirt}<\/B><BR>&nbsp;&nbsp; => <B>{sandals}<\/B><BR><BR>support = 0.0769<BR>confidence = 1<BR>coverage = 0.0769<BR>lift = 7.43<BR>count = 4<BR>order = 2<BR>id = 10","<B>[11]<\/B><BR><B>{shorts,<BR>&nbsp;&nbsp;t-shirt}<\/B><BR>&nbsp;&nbsp; => <B>{sandals}<\/B><BR><BR>support = 0.0769<BR>confidence = 1<BR>coverage = 0.0769<BR>lift = 7.43<BR>count = 4<BR>order = 3<BR>id = 11","<B>[12]<\/B><BR><B>{sandals}<\/B><BR>&nbsp;&nbsp; => <B>{t-shirt}<\/B><BR><BR>support = 0.0769<BR>confidence = 0.571<BR>coverage = 0.135<BR>lift = 7.43<BR>count = 4<BR>order = 2<BR>id = 12","<B>[13]<\/B><BR><B>{potato chips}<\/B><BR>&nbsp;&nbsp; => <B>{drink mix}<\/B><BR><BR>support = 0.0962<BR>confidence = 0.833<BR>coverage = 0.115<BR>lift = 7.22<BR>count = 5<BR>order = 2<BR>id = 13","<B>[14]<\/B><BR><B>{drink mix}<\/B><BR>&nbsp;&nbsp; => <B>{potato chips}<\/B><BR><BR>support = 0.0962<BR>confidence = 0.833<BR>coverage = 0.115<BR>lift = 7.22<BR>count = 5<BR>order = 2<BR>id = 14","<B>[15]<\/B><BR><B>{athletic shoes}<\/B><BR>&nbsp;&nbsp; => <B>{shorts}<\/B><BR><BR>support = 0.0769<BR>confidence = 1<BR>coverage = 0.0769<BR>lift = 6.5<BR>count = 4<BR>order = 2<BR>id = 15"],"shape":["box","box","box","box","box","box","box","box","box","box","box","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle"],"x":[-0.3204058738066311,0.7660796516969077,-0.7926874220933651,0.9590855279611228,-0.0793038216592723,-0.1245738942833133,-0.928592699156025,0.540221182325956,0.05565282071143218,-0.4977739004190452,0.4061874564957422,1,0.7209780627874456,-0.3034580700798343,0.1983204717649798,-0.5088292157612677,-0.6968155162073078,-0.1698245857323705,-0.3162565911444326,0.1175856784192599,0.7464201650488536,0.3582130691091439,0.5515004489325774,-1,-0.7127448102468614,0.03907713060427587],"y":[0.8238643529338654,0.5218813577766026,-0.426986801997668,0.6859575064798926,-1,-0.7017221171110717,-0.01569034353590648,-0.1194051928959545,0.3945047892676101,0.6724805093060657,-0.2345449469882865,0.4034533558882536,0.7984763334926908,0.4718118443172601,-0.003569057959340816,1,0.7572440806878227,0.6445316996031607,-0.8666293039597999,-0.8523974670729435,-0.2798183344578973,0.1254423769110771,-0.4640147446367754,-0.2645203924510615,-0.1782190657875719,0.7975425789775195]},"edges":{"from":[2,4,9,10,8,9,1,10,1,9,6,5,11,9,11,8,7,3,1,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],"to":[12,13,14,14,15,15,16,17,18,18,19,20,21,22,22,23,24,25,26,4,2,1,11,10,1,10,5,6,8,8,11,3,7,9],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"hover":true,"zoomSpeed":1}},"groups":["1","2"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Examining the above list/table, along side the visual graph - it seems like there a good number of associated products with relatively high lift. This means that the association is stronger and more useful to us - having a customer place one of the items on the left hand side (lhs) greatly increases the likelihood that they’ll also place the item(s) on the right hand side(rhs) into their basket as well. The support (relative frequency) for this generated association list was set to 7%, meaning that the combination of items had to occur in at least 7% of transactions. The same setting was used for confidence, a relative measure of how frequently the combination occurs together vs.&nbsp;the individual items themselves across the transaction list.</p>
<p>It looks like summer may be coming a bit early! Customers are stocking up on some summer necessitites - clothing like shorts, tshirts, sandals, socks, and athletic shoes all seem to be going together. Some customers are also getting potato chips and drink mix - so going outside and enjoying oneself is in.</p>
<p>Shorts seem to be at the center of a lot of combined purchases. Any time someone looks into shorts, we should probably recommend that they look at socks and athletic shoes (or t-shirts and sandals). The converse is true for that, too - if someone’s looking at sandals, we might recommend tshirts and shorts. We may also recommend shorts and socks if they’re looking into athletic shoes.</p>
<p>Really a no-brainer, but there are some purchases of laptops going on right now, and they have a strong connection to computer mouses. We should continue to recommend peripherals to users that are browsing for laptops.</p>
<p>Overall - by examining what customers are purchasing, and having more information on them, we should be able to take, apply, expand, and improve these methods so that predictive models can give us better results - more purchases of related items, and more customers with credit cards from our company.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>